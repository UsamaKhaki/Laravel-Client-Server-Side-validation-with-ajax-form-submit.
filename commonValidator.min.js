$.fn.commonValidator=function(e){"use strict";var r=this,t={rules:{},errorType:"validator",data:"default",showErrors:"normal",formAutocomplete:!0,reponseDelay:1e3,useDefualtLoader:!0,showLoadingParent:"body",loaderBody:'<div class="loader-wrapper" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; flex-flow: column; text-align: center; font-weight: 600; font-size: 14px; background: rgba(255, 255, 255, 0.9); z-index: 10000000"><div style="margin-bottom: 10px; border: 5px solid #f3f3f3;border-top: 5px solid #8bc34a;border-radius: 50%;width: 40px;height: 40px;animation: spin 2s linear infinite;" id="custom-loader"></div>Submitting Form <br> please wait....</div>',errorCss:{color:"red","font-size":"13px",display:"block","font-weight":"600","margin-top":"2px","margin-bottom":"0"},beforeSubmit:function(){return!0},success:e=>{alert("Form submitted Successfully")},error:(e,r,t)=>{alert("Form submit failed!")}},o=0;function s(){var e=document.getElementById("custom-loader");$(e).length&&(e.style.MozTransform="rotate("+o+"deg)",e.style.WebkitTransform="rotate("+o+"deg)",360==o&&(o=0),o+=5,window.setTimeout(s,10))}var a=$.extend({},t,e);return this.each(function(){a.formAutocomplete&&r.attr("autocomplete","Off");var e=r.validate({ignore:"[name*='']",submitHandler:function(t){if(a.beforeSubmit()){if(a.useDefualtLoader){var o=$(a.showLoadingParent);o.css("position","relative"),$(o).append(a.LoaderBody),window.setTimeout(s,100)}if("default"==a.data)var n=new FormData(t);else n=a.data;$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},url:$(t).attr("action"),type:"POST",data:n,processData:!1,contentType:!1,success:function(t){setTimeout(()=>{if(a.useDefualtLoader&&$(".loader-wrapper").remove(),"Error"==t.status){if("custom"==a.errorType)$("label[data-server-error]").html(""),$.each(t.errors,function(e,r){$.each($("input:visible, select:visible, textarea:visible"),function(t,o){if($(o).attr("name")==e)if($('label[data-server-error="'+e+'-error"]').length)$('label[data-server-error="'+e+'-error"]').html(r);else{var s="";$.each(a.errorCss,function(e,r){s+=e+": "+r+"; "});var n='<label style="'+s+'" data-server-error="'+e+'-error">'+r+"</label>";$(o).parent(".input-group").length?$(n).insertAfter($(o).parent()):$(o).data("select2")?$(o).parent(".form-group").append($(n)):$(o).parent("td").length?$(n).insertAfter($(o).parent()):$(o).closest("div").length?$(o).closest("div").append($(n)):$(n).insertAfter($(o))}})});else if("validator"===a.errorType){var o={};$.each(t.errors,function(e,r){$.each(r,function(r,t){o[e]=t})}),e.showErrors(o)}}else"Success"==t.status?($(r)[0].reset(),a.success(t)):(alert("Something went wrong, please contact admin"),console.error(t))},a.reponseDelay)},error:function(e,r,t){setTimeout(()=>{a.useDefualtLoader&&$(".loader-wrapper").remove(),a.error(e,r,t)},a.reponseDelay)}})}else console.error("Before submit is "+a.beforeSubmit())},errorElement:"label",errorClass:"error",showErrors:function(e,r){if("tooltip"==a.showErrors)return $.each(this.successList,function(e,r){var t=$(r),o=t.closest(".form-group");return o.removeClass("has-error").addClass("has-success"),t.hasClass("select2-hidden-accessible")&&(t=o.find(".select2")),o.removeClass("has-success"),t.tooltip("destroy")}),$.each(r,function(e,r){var t=$(r.element),o=t.closest(".form-group");return t.hasClass("select2-hidden-accessible")&&(t=o.find(".select2")),o.hasClass("has-error")||o.removeClass("has-success").addClass("has-error"),t.attr("data-toggle","tooltip").attr("title",r.message),t.tooltip("fixTitle").tooltip()});"normal"==a.showErrors&&this.defaultShowErrors()},errorPlacement:function(e,r){e.css(a.errorCss),r.parent(".input-group").length?e.insertAfter(r.parent()):r.data("select2")?r.parent(".form-group").append(e):r.parent("td").length?e.insertAfter(r.parent()):r.closest("div").length?r.closest("div").append(e):e.insertAfter(r)},rules:a.rules});$("input, select, textarea").on("change",function(){$(this).valid(),$("label[data-server-error='"+$(this).attr("name")+"-error']").remove()}),$(document).on("input","input[type='tel']",function(){this.value=this.value.replace(/\D/g,"")})})};
